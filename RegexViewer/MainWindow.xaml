<Window x:Class="RegexViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"

        xmlns:local="clr-namespace:RegexViewer"

        Title="RegexViewer" Height="350" Width="525">

    <Window.Resources>
        <local:LogViewModel x:Key="logViewModel" />
        <local:FilterViewModel x:Key="filterViewModel" />
        <local:MainViewModel x:Key="mainViewModel" />
        <local:RegexViewerSettings x:Key="settings" />
        <local:ItemViewModel x:Key="itemViewModel" />
    </Window.Resources>
    <!--<Window.CommandBindings>

        <CommandBinding Command="{StaticResource logViewModel.CopyCmdCanExecute}"
                  Executed="{Binding Executed}"
                  CanExecute="{Binding CanExecute}"/>
    </Window.CommandBindings>-->
    <!--<i:Interaction.Triggers>
            <i:EventTrigger EventName="Closing">
                <command:EventToCommand Command="{Binding WindowClosing}" />
            </i:EventTrigger>
        </i:Interaction.Triggers>-->
    <!--xmlns:i="clr-namespace:Microsoft.Expression.Interactivity;assembly=Microsoft.Expression.Interactions"-->
    <DockPanel DataContext="{StaticResource mainViewModel}">
       
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_Open" Command="{Binding LogViewModel.OpenCommand}" CommandParameter="{Binding}" />
                <MenuItem Header="_Close" Command="{Binding LogViewModel.CloseCommand}" CommandParameter="{Binding}" />
            </MenuItem>
            <MenuItem Header="_Filter">
                <MenuItem Header="_Open" Command="{Binding FilterViewModel.OpenCommand}" CommandParameter="{Binding}" />
                <MenuItem Header="_Close" Command="{Binding FilterViewModel.CloseCommand}" CommandParameter="{Binding}" />
                <MenuItem Header="_Save" />
            </MenuItem>
            <MenuItem Header="_Options">
                <MenuItem Header="_Settings" />
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Help" />
            </MenuItem>
        </Menu>
        <Grid>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="5" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TabControl x:Name="tabFilters" Grid.Column="0" HorizontalAlignment="Stretch" Margin="0,0,0,0" VerticalAlignment="Stretch">

                <DataGrid Name="dataGridFilter" Grid.Column="0" HorizontalAlignment="Stretch" Margin="0,0,0,0" VerticalAlignment="Stretch">
                </DataGrid>
            </TabControl>
            <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" Width="5">
            </GridSplitter>
            <TabControl x:Name="tabLogs" Grid.Column="2" HorizontalAlignment="Stretch"
                        Margin="0,0,0,0" VerticalAlignment="Stretch" ItemsSource="{Binding Path=LogViewModel.TabItems}" SelectedIndex="{Binding Path=LogViewModel.SelectedIndex, Mode=TwoWay}">
                <TabControl.ItemTemplate>
                    <!-- this is the header template-->
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=Header}" />
                    </DataTemplate>
                </TabControl.ItemTemplate>
                <TabControl.ContentTemplate>
                    <!-- this is the body of the TabItem template-->
                    <DataTemplate>
                        <ListBox Name="logFileData" 
                                 ItemsSource="{Binding Path=ContentList}"  
                                 AllowDrop="True" 
                                 SelectionMode="Extended" 
                                 Background="{Binding Source={StaticResource settings}, Path=Settings.BackgroundColor}">
                            <!--<ListBox.SelectedItems>
                                --><!--<ListBox.SelectedItem SelectedIndex="{Binding Path=LogViewModel.SelectedIndex, Mode=TwoWay}" />--><!--
                                <Style TargetType="{x:Type ListBoxItem}" BasedOn="{StaticResource {x:Type ListBoxItem}}">
                                <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
                            </Style>
                            </ListBox.SelectedItems>-->
                                 
                            <!--<ListBox.CommandBindings>
                                <CommandBinding Command="ApplicationCommands.Copy" CanExecute="{Binding CtrlCCopyCmdCanExecute}" Executed="{Binding CtrlCCopyCmdExecuted}" />
                            </ListBox.CommandBindings>-->
                            <ListBox.ContextMenu>
                                <ContextMenu HasDropShadow="True">
                                    <!--<MenuItem Header="Copy" Command="{Binding CopyCommand}" CommandParameter="{Binding ElementName=logFileData,Path=SelectedItems, Mode=TwoWay}"/>-->
                                    <MenuItem Header="Copy" Command="{Binding CopyCommand}" />
                                    <MenuItem Command="ApplicationCommands.SelectAll"/>
                                   
                                </ContextMenu>
                            </ListBox.ContextMenu>
                            <!--<ListBox.SelectedItems>
                            <Style TargetType="{x:Type ListBox}" BasedOn="{StaticResource {x:Type ListBox}}">
                                <Setter Property="SelectedItems" Value="{Binding SelectedItems, Mode=TwoWay}" />
                            </Style>
                            </ListBox.SelectedItems>-->
                        </ListBox> 
                    </DataTemplate>
                </TabControl.ContentTemplate>
                <TabControl.ContextMenu>
                    <ContextMenu HasDropShadow="True">
                        <!--<MenuItem Header="Copy" Command="ApplicationCommands.Copy" CommandTarget="{Binding ElementName=logFileData}" />-->
                        <MenuItem Header="Close" Command="{Binding LogViewModel.CloseCommand}" />
                        <!--<MenuItem Header="Copy" Command="{Binding LogViewModel.CopyCommand}" CommandTarget="{Binding ElementName=logFileData}"/>-->
                    </ContextMenu>
                </TabControl.ContextMenu>
            </TabControl>
        </Grid>
    </DockPanel>
</Window>
